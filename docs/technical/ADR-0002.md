# ADR-0002: Implementação de Acessibilidade Básica (WCAG 2.1 Nível A)

## Vinculado a
TASK-0009

## Status
Accepted

## Contexto
O projeto Instituto Jardim não possuía recursos básicos de acessibilidade para usuários de tecnologias assistivas, como leitores de tela e navegação por teclado. A auditoria de qualidade (TASK-0002) identificou duas melhorias de acessibilidade críticas do tipo "Quick Win":

- **MA-001**: Skip link ausente - usuários de teclado precisavam navegar por todo o cabeçalho antes de acessar o conteúdo principal
- **MA-004**: Labels de formulário ausentes - o campo de nome do paciente no calendário de agendamento não possuía `<label>` associado, apenas um `<h3>` não relacionado semanticamente ao input

Esses problemas violam os critérios WCAG 2.1 Nível A:
- 2.4.1 Bypass Blocks (skip link)
- 1.3.1 Info and Relationships (labels)
- 3.3.2 Labels or Instructions (labels)

## Decisão

### MA-001: Skip Link
Implementamos um skip link seguindo as melhores práticas de acessibilidade:

**Localização**: Adicionado em `index.html` antes do `<div id="root">` para garantir que seja o primeiro elemento focável da página.

**HTML**:
```html
<a href="#conteudo-principal" class="skip-link">Pular para o conteúdo principal</a>
```

**Destino**: Adicionado `id="conteudo-principal"` e `tabindex="-1"` no elemento `<main>` em `App.tsx` para permitir foco programático.

**Estilo** (em `globais.css`):
- `position: absolute; top: -40px` - oculto por padrão
- `:focus { top: 0 }` - visível apenas quando focado
- `z-index: 9999` - garante visibilidade sobre outros elementos
- Estilização com cores de alto contraste (fundo escuro, texto branco)

**Comportamento**:
- Ao pressionar Tab no carregamento da página, o skip link é o primeiro elemento focado
- Pressionar Enter move o foco diretamente para o conteúdo principal, pulando o cabeçalho

### MA-004: Labels de Formulário
Substituímos o `<h3>` por `<label>` semanticamente correto no campo de nome do paciente:

**Antes**:
```tsx
<h3 className={estilos.subtitulo}>Nome do Paciente</h3>
<input type="text" placeholder="Digite seu nome completo" />
```

**Depois**:
```tsx
<label htmlFor="nome-paciente" className={estilos.subtitulo}>
  Nome do Paciente
</label>
<input
  id="nome-paciente"
  type="text"
  placeholder="Digite seu nome completo"
  required
  aria-required="true"
  aria-describedby="nome-instrucao"
/>
<span id="nome-instrucao" className={estilos.instrucao}>
  Digite o nome completo do paciente para identificação no agendamento
</span>
```

**Atributos de acessibilidade adicionados**:
- `htmlFor/id`: Associação semântica entre label e input
- `required` + `aria-required="true"`: Indica que o campo é obrigatório
- `aria-describedby`: Associa instrução descritiva ao input para leitores de tela

**Preservação visual**: A classe `estilos.subtitulo` foi mantida no `<label>` para preservar exatamente o mesmo estilo visual do `<h3>` anterior, evitando regressão visual.

## Consequências

### Positivas
- **Conformidade WCAG**: Projeto agora atende aos critérios 2.4.1, 1.3.1 e 3.3.2 (Nível A)
- **Navegação por teclado**: Usuários podem pular diretamente para o conteúdo principal com apenas 2 teclas (Tab + Enter)
- **Leitores de tela**: Campo de nome agora é anunciado corretamente como "Nome do Paciente, campo obrigatório, Digite o nome completo do paciente para identificação no agendamento"
- **Usabilidade**: Clicar no label agora foca automaticamente o input (comportamento nativo de `<label>`)
- **SEO**: Uso de `<main>` e estrutura semântica correta melhora compreensão da página por bots
- **Zero impacto visual**: Mudanças são completamente transparentes para usuários visuais
- **Tempo de implementação**: 45 minutos (abaixo da estimativa de 0.75h)

### Negativas
- **Manutenção**: Nova classe CSS `.instrucao` precisa ser mantida no design system
- **Ligeiro aumento no DOM**: Adição de elementos `<span>` para instruções (impacto negligenciável)
- **Responsabilidade**: Futuros formulários devem seguir o mesmo padrão de labels + aria-describedby

## Alternativas Consideradas

### Alternativa 1: Skip link dentro do React (em App.tsx)
- **Descrição**: Renderizar o skip link como parte do componente React ao invés de HTML estático
- **Motivo da rejeição**: Skip link precisa ser renderizado imediatamente, antes do hydration do React, para garantir que seja o primeiro elemento focável. Renderizar via React poderia causar delay ou ordem incorreta de foco.

### Alternativa 2: Usar apenas aria-label no input (sem <label> visível)
- **Descrição**: Manter o `<h3>` visual e adicionar `aria-label="Nome do Paciente"` no input
- **Motivo da rejeição**:
  - Viola as melhores práticas (labels visíveis beneficiam todos os usuários)
  - Não permite clicar no label para focar o input
  - Critério WCAG 3.3.2 recomenda labels visíveis, não apenas aria-label

### Alternativa 3: Ocultar instrução descritiva visualmente (sr-only)
- **Descrição**: Usar classe `.sr-only` para tornar a instrução invisível, visível apenas para leitores de tela
- **Motivo da rejeição**: Instruções descritivas beneficiam todos os usuários, não apenas usuários de leitores de tela. Torná-las visíveis melhora a UX geral. A instrução está estilizada discretamente (cor secundária, fonte menor) para não poluir visualmente.

## Notas de Implementação

**Arquivos modificados**:
1. `/index.html` - Skip link adicionado
2. `/src/estilos/globais.css` - Estilos do skip link
3. `/src/App.tsx` - Elemento `<main>` com id e tabindex
4. `/src/componentes/CalendarioAgendamento/CalendarioAgendamento.tsx` - Label e atributos aria
5. `/src/componentes/CalendarioAgendamento/CalendarioAgendamento.module.css` - Estilos da instrução

**Validações realizadas**:
- `npm run lint` - Passou sem erros
- `npm run build` - Compilado com sucesso
- Navegação por teclado - Skip link focável e funcional
- DevTools Accessibility Tree - Label corretamente associado ao input

## Próximos Passos Recomendados
Após esta implementação, outras melhorias de acessibilidade identificadas na TASK-0002 incluem:
- MA-006: Ajustar contraste de cores para WCAG AA (TASK-0012)
- MA-002: Adicionar landmarks ARIA (`<nav>`, `<footer>`, etc.)
- MA-005: Mensagens de erro acessíveis em validações de formulário
- MA-003: Adicionar live regions para anúncios dinâmicos (ex: "Data selecionada: ...")
