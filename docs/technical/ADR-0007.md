# ADR-0007: Melhorias UX para Datas Indisponíveis no Calendário

## Status
Aceito

## Data
2026-02-08

## TASK Relacionada
TASK-0013

## Contexto

O calendário de agendamento exibia datas indisponíveis apenas com opacidade reduzida (0.4), sem nenhuma explicação visual ou textual do motivo. Isso causava confusão e frustração nos usuários, que tentavam clicar em datas indisponíveis sem entender por que não conseguiam selecioná-las.

Problemas identificados:
- Falta de diferenciação visual clara entre datas disponíveis e indisponíveis
- Ausência de feedback explicando por que uma data não está disponível
- Sem indicação de qual é a data de hoje
- Falta de legenda explicando os diferentes estados visuais

## Decisão

Implementamos um conjunto de melhorias visuais e de acessibilidade:

### 1. Visual aprimorado para datas indisponíveis
- Opacity reduzida de 0.4 para 0.3 (maior diferenciação)
- Background color alterado para `#F9F9F9`
- Adicionado pseudo-elemento `::after` com linha diagonal (45°) simulando "riscado"
- Mantido `cursor: not-allowed` para feedback visual ao hover

### 2. Tooltips explicativos
- Atributo `title` nativo do HTML para datas indisponíveis
- Mensagens contextualizadas baseadas no dia da semana:
  - "Profissional não atende aos domingos"
  - "Profissional não atende às [dia-da-semana]s"
- Para datas disponíveis, tooltip mostra a data completa e instrução de clique

### 3. Indicador visual para "hoje"
- Borda destacada com `var(--cor-marrom-claro)`
- Box-shadow sutil com cor da borda (opacity 0.2)
- Pseudo-elemento `::before` como badge circular no canto superior direito

### 4. Legenda do calendário
- Exibida logo abaixo da grade de datas
- Três estados claramente representados:
  - Disponível: quadrado branco com borda
  - Hoje: quadrado branco com borda marrom e badge
  - Indisponível: quadrado cinza com linha diagonal
- Layout flexível, adaptável para mobile (flex-direction: column)

### 5. Melhoria no hover de datas disponíveis
- Adicionado `transform: translateY(-2px)` para efeito de elevação
- Box-shadow aplicado no hover para reforçar interatividade

## Alternativas Consideradas

### Alternativa 1: Tooltip customizado com JavaScript
- **Descrição**: Criar componente de tooltip customizado com `onMouseEnter`/`onMouseLeave` e estado React
- **Motivo da rejeição**:
  - Adicionaria complexidade desnecessária
  - Atributo nativo `title` funciona bem em desktop
  - Mobile não tem hover, então legenda visual é suficiente
  - Aumentaria bundle size sem benefício significativo

### Alternativa 2: Modal explicativo ao clicar em data indisponível
- **Descrição**: Exibir modal com explicação detalhada ao clicar em data desabilitada
- **Motivo da rejeição**:
  - Interrompe o fluxo do usuário
  - Tooltip + legenda já fornecem informação clara
  - Modal seria intrusivo e prejudicaria UX

### Alternativa 3: Usar ícone SVG no lugar da linha diagonal CSS
- **Descrição**: Renderizar ícone SVG de "X" ou "proibido" nas datas indisponíveis
- **Motivo da rejeição**:
  - Aumentaria bundle size com SVG inline
  - Pseudo-elemento CSS é mais performático
  - Visual sutil é preferível a ícone destacado

### Alternativa 4: Destacar "hoje" com background colorido
- **Descrição**: Usar background `var(--cor-marrom-claro)` para a data de hoje
- **Motivo da rejeição**:
  - Pode conflitar visualmente com estado "selecionada"
  - Borda + badge são suficientes e mais sutis
  - Usuários podem confundir com seleção ativa

## Consequências

### Positivas
- **Clareza visual**: Usuários entendem rapidamente quais datas estão disponíveis
- **Feedback contextual**: Tooltips explicam o motivo da indisponibilidade
- **Orientação ao usuário**: Legenda serve como guia de uso do calendário
- **Melhor UX**: Reduz frustração e tentativas de clique em datas indisponíveis
- **Acessibilidade**: `aria-disabled` reforça estado para screen readers
- **Performance**: Solução baseada em CSS puro (pseudo-elementos), sem overhead de JavaScript
- **Manutenibilidade**: Código simples e fácil de entender
- **Consistência**: Usa variáveis CSS do design system existente

### Negativas
- **Tooltips em mobile**: Atributo `title` não funciona em touch devices, mas legenda visual compensa
- **Visual mais carregado**: Legenda adiciona elemento visual à interface, mas discreto
- **Pseudo-elementos**: Podem ter compatibilidade limitada em navegadores muito antigos (irrelevante em 2026)

## Notas de Implementação

- Hoje é identificado comparando `data.toDateString()` com `new Date().toDateString()`
- Tooltips são gerados dinamicamente baseados no dia da semana
- Legenda usa a mesma estrutura de classes CSS que o calendário para consistência
- Responsividade: legenda muda para layout vertical em telas < 768px
- Todos os estilos respeitam variáveis CSS do design system (`variaveis.css`)

## Referências
- TASK-0013: `/docs/backlog/TASK-0013.md`
- PRD-0002: `/docs/planning/PRD-0002_validated.md` (Quick Win MUX-005)
- Matriz de Priorização: `/docs/planning/MATRIZ-PRIORIZACAO.md`
