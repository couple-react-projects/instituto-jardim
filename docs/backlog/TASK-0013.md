# TASK-0013: Melhoria UX de datas indisponiveis no calendario

## Metadata
- **ID**: TASK-0013
- **Branch**: feature/TASK-0013
- **Depends on**: TASK-0010
- **PRD Reference**: PRD-0002
- **Quick Wins Cobertos**: MUX-005
- **Tempo Estimado**: 2-3h

## Objetivo

Melhorar a experiencia do usuario no calendario de agendamento adicionando indicadores visuais e textuais claros para datas indisponiveis. Atualmente, datas indisponiveis aparecem apenas com opacidade reduzida (0.4), sem explicacao do motivo, gerando frustacao e tentativas de clique inuteis.

## Escopo Tecnico

### MUX-005: Melhoria na visualizacao de datas indisponiveis

**Arquivos afetados:**
- `src/componentes/CalendarioAgendamento/CalendarioAgendamento.tsx` - logica de tooltip e legenda
- `src/componentes/CalendarioAgendamento/CalendarioAgendamento.module.css` - estilos visuais

**Estado atual (CalendarioAgendamento.module.css):**
```css
.dia:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

.diaIndisponivel {
  opacity: 0.4;
  cursor: not-allowed;
}
```

**Abordagem sugerida:**

1. **Indicador visual em dias indisponiveis:**
   - Adicionar pseudo-elemento `::after` com icone visual (X sutil ou barra diagonal) via CSS
   - Reduzir opacity para 0.3 (maior diferenciacao visual)

2. **Tooltip ao hover:**
   - Adicionar atributo `title` nos botoes de datas indisponiveis com mensagem explicativa
   - Mensagens contextuais baseadas no motivo:
     - "Profissional nao atende neste dia da semana"
     - "Profissional nao atende aos domingos"
   - Para mobile (onde hover nao existe): tooltip pode ser exibido em `onTouchStart` ou `onClick` do botao desabilitado
   - Alternativa mais simples: usar apenas o atributo nativo `title` que funciona em desktop e mostra tooltip nativo

3. **Legenda do calendario:**
   - Adicionar legenda visual abaixo da grade de datas
   - Quadrado verde/com cor primaria: "Disponivel"
   - Quadrado cinza com X: "Indisponivel"
   - Estilizar legenda de forma discreta para nao poluir a interface

**Edge cases a considerar:**
- Tooltip nativo (`title`) nao funciona em touch devices -- considerar implementacao com CSS puro (`:hover::after` com `content`) ou aceitar que mobile usa apenas legenda visual
- Datas passadas vs datas em que profissional nao atende podem ter motivos diferentes
- Verificar como a legenda se comporta em telas pequenas (responsividade)
- Manter compatibilidade com a logica de selecao existente (`handleDataClick`)
- Garantir que `disabled` e `aria-disabled` estejam corretos nos botoes indisponiveis
- Verificar interacao com a TASK-0012 (contraste) -- cores da legenda devem respeitar WCAG

## Criterios de Aceitacao

- [ ] Datas indisponiveis possuem indicador visual alem de opacidade (X, barra ou padrao visual)
- [ ] Ao passar mouse sobre data indisponivel em desktop, tooltip aparece com explicacao
- [ ] Legenda do calendario esta visivel abaixo da grade de datas
- [ ] Legenda descreve corretamente os estados (disponivel/indisponivel)
- [ ] Funcionalidade de selecao de datas disponiveis continua inalterada
- [ ] Layout responsivo da legenda funciona em telas pequenas
- [ ] `npm run build` executa sem erros
- [ ] `npm run lint` passa sem erros

## Test Strategy
- Unit tests: Nao
- API tests: Nao
- Integration tests: Nao
- Validacao manual: Sim - testar hover em datas indisponiveis, verificar legenda, testar em viewport mobile, verificar que selecao de datas funciona normalmente

## Definition of Done
- [ ] Codigo implementado conforme especificacao
- [ ] Build passando (`npm run build` sem erros)
- [ ] Lint passando (`npm run lint` sem erros)
- [ ] Tooltip funcional em desktop
- [ ] Legenda visivel e descritiva
- [ ] Code review aprovado pelo Tech Lead
- [ ] QA validado pelo Tech Lead

## Status: DONE

## Code Review & QA (Consolidated) - 2026-02-08

### Resultado: APROVADO

**Build**: OK (vite v7.3.1, 57 modules, 521ms)
**Lint**: OK (0 warnings, 0 errors)
**ADR**: ADR-0007 criado

### Verificacao Tecnica
- [x] Opacity datas indisponiveis ajustado: 0.4 -> 0.3
- [x] Indicador visual (linha diagonal) via pseudo-elemento ::after
- [x] Indicador visual "hoje" com borda marrom e badge
- [x] Tooltips contextuais via atributo title
- [x] Legenda com 3 estados (disponivel/hoje/indisponivel)
- [x] Hover aprimorado com transform e shadow
- [x] Build passando sem erros
- [x] Lint passando sem erros

### Verificacao de Negocio (PRD-0002)
- [x] MUX-005: UX datas indisponiveis - ATENDIDO
